<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>みんなの回答</title>
  <style>
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans JP", sans-serif;
      background: linear-gradient(180deg,#e0f2ff,#fff);
      color:#10203a;
      padding:16px;
    }
    .wrap{ max-width:820px; margin:0 auto; }
    h1{ margin:0 0 8px; font-size:22px; }
    .pill{
      display:inline-block;
      padding:6px 12px;
      border-radius:999px;
      background:#fff;
      box-shadow:0 4px 10px rgba(0,0,0,.15);
      font-size:12px;
      margin-bottom:12px;
    }
    .card{
      background:#fff;
      border-radius:20px;
      padding:16px;
      box-shadow:0 12px 30px rgba(0,0,0,.18);
    }
    .question{
      font-size:18px;
      font-weight:800;
      white-space:pre-line;
    }
    .dialogue{
      margin-top:10px;
      padding:12px;
      background:#f3f7ff;
      border-radius:14px;
      font-size:14px;
      line-height:1.5;
    }
    .choices{
      display:grid;
      grid-template-columns:1fr;
      gap:12px;
      margin-top:16px;
    }
    @media(min-width:600px){
      .choices{ grid-template-columns:1fr 1fr; }
    }
    .choice{
      padding:18px;
      border-radius:18px;
      font-size:17px;
      font-weight:800;
      background:#fff;
      border:3px solid #dbe5ff;
      cursor:pointer;
      text-align:center;
    }
    .choice:active{ transform:scale(.98); }
    .arena{
      margin-top:10px;
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      justify-content:center;
    }
    .person{
      width:44px;height:44px;
      border-radius:14px;
      display:flex;
      align-items:center;
      justify-content:center;
      background:#e6f0ff;
      font-weight:900;
    }
    .overlay{
      position:fixed;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      background:rgba(0,0,0,.25);
    }
    .overlay.show{ display:flex; }
    .pop{
      background:linear-gradient(90deg,#6ee7b7,#fde68a,#fca5a5);
      padding:28px 32px;
      border-radius:28px;
      text-align:center;
      font-size:30px;
      font-weight:1000;
      box-shadow:0 30px 80px rgba(0,0,0,.35);
      animation:pop .2s ease-out;
    }
    @keyframes pop{ from{transform:scale(.8)} to{transform:scale(1)} }
  </style>
</head>

<body>
<div class="wrap">
  <h1>みんなの回答</h1>
  <div class="pill" id="status">問題 1 / 4</div>

  <div class="card">
    <div class="question" id="questionText"></div>
    <div class="dialogue" id="dialogueBox" style="display:none;"></div>

    <div class="choices">
      <div class="choice" id="btnA"></div>
      <div class="choice" id="btnB"></div>
    </div>

    <div class="arena" id="arena"></div>
  </div>
</div>

<div class="overlay" id="overlay">
  <div class="pop" id="overlayText">こっちが多い！</div>
</div>

<script>
const questions = [
  {
    text: '問題１\n“He is running.”\nどっちの意味？',
    a: '彼は走っている',
    b: '彼は走りたい'
  },
  {
    text: '問題２\nどっちが自然かな？',
    a: 'I like apple.',
    b: 'I like apples.'
  },
  {
    text: '問題３\n今聞こえたのはどっち？',
    a: 'ship',
    b: 'sheep'
  },
  {
    text: '問題４\n（英語の会話を見て）\nこのあと、なにをすると思う？',
    a: '学校に行く',
    b: '家に帰る',
    dialogue: [
      'Mom: Hurry up!',
      'It’s time for school.',
      'Boy: OK!'
    ]
  }
];

const TOTAL = 4;
let q = 0;
let count = 0;
let votes = [];

const qText = document.getElementById('questionText');
const dBox = document.getElementById('dialogueBox');
const btnA = document.getElementById('btnA');
const btnB = document.getElementById('btnB');
const arena = document.getElementById('arena');
const overlay = document.getElementById('overlay');
const overlayText = document.getElementById('overlayText');
const status = document.getElementById('status');

function render(){
  const qu = questions[q];
  status.textContent = `問題 ${q+1} / ${questions.length}`;
  qText.textContent = qu.text;
  btnA.textContent = 'A：' + qu.a;
  btnB.textContent = 'B：' + qu.b;
  arena.innerHTML = '';
  votes = [];
  count = 0;

  if(qu.dialogue){
    dBox.style.display = '';
    dBox.innerHTML = qu.dialogue.join('<br>');
  }else{
    dBox.style.display = 'none';
  }
}

function vote(choice){
  if(count>=TOTAL) return;
  count++;
  votes.push(choice);
  const p = document.createElement('div');
  p.className = 'person';
  p.textContent = count;
  arena.appendChild(p);

  if(count===TOTAL){
    setTimeout(showResult,300);
  }
}

function showResult(){
  const a = votes.filter(v=>v==='A').length;
  const b = votes.filter(v=>v==='B').length;

  if(a>b){
    overlayText.textContent = 'A が多い！';
  }else if(b>a){
    overlayText.textContent = 'B が多い！';
  }else{
    overlayText.textContent = 'イーブン！';
  }
  overlay.classList.add('show');

  setTimeout(()=>{
    overlay.classList.remove('show');
    q++;
    if(q<questions.length){
      render();
    }
  },3000);
}

btnA.onclick = ()=>vote('A');
btnB.onclick = ()=>vote('B');

render();
</script>
</body>
</html>
